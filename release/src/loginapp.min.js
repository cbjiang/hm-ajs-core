var LoginApp=angular.module("LoginApp",["ui.router","ngSanitize","ngStorage"]);null!=hmappSystemConfig&&(LoginApp.constant("SYSNAME",hmappSystemConfig.SYSNAME),LoginApp.constant("GATEWAYURL",hmappSystemConfig.GATEWAYURL),LoginApp.constant("INDEXURL",hmappSystemConfig.INDEXURL)),LoginApp.directive("ngDoLogin",["$location","AuthServer",function(n,o){function e(){var n=$('[name="username"]').val(),e=$('[name="password"]').val(),t=$('[name="remember"]').prop("checked");o.login(n,e,t)}return{link:function(n,o,t){"BUTTON"==o[0].tagName?o.bind("click",function(){e()}):"INPUT"==o[0].tagName&&o.bind("keydown",function(n){13==n.keyCode&&e()})}}}]),LoginApp.directive("ngKeyDownLogin",["$location","AuthServer",function(n,o){return{link:function(n,e,t){e.bind("keydown",function(n){n.keyCode;var e=$('[name="username"]').val(),t=$('[name="password"]').val(),i=$('[name="remember"]').prop("checked");o.login(e,t,i)})}}}]),LoginApp.factory("AuthServer",["$http","$location","$localStorage","$sessionStorage","GATEWAYURL","SYSNAME","INDEXURL",function(n,o,e,t,i,a,r){return{login:function(c,p,u){n({method:"POST",url:i+"api/authenticate",params:{},data:{username:c,password:p,rememberMe:u}}).success(function(n,i,c,p){console.log("success");var l=n.id_token;null!=l&&(u?e.authenticationToken=l:t.authenticationToken=l,window.location=o.protocol()+"://"+o.host()+":"+o.port()+"/"+a+"/"+r)}).error(function(n,o,e,t){console.log("error"),$("#loginAlert").removeClass("hide")})}}}]);