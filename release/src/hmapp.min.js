function matchMenu(e){$("#jquery-accordion-menu").find("li").length>0?(Layout.setSidebarMenuActiveLink("match"),e()):setTimeout(function(){matchMenu(e)},100)}var HMApp=angular.module("HMApp",["ui.router","ui.bootstrap","oc.lazyLoad","ngSanitize","ngStorage","hm.fileupload"]);null!=hmappSystemConfig&&(HMApp.constant("SYSNAME",hmappSystemConfig.SYSNAME),HMApp.constant("SYSCODE",hmappSystemConfig.SYSCODE),HMApp.constant("VERSION",hmappSystemConfig.VERSION),HMApp.constant("GATEWAYURL",hmappSystemConfig.GATEWAYURL),HMApp.constant("LOGINURL",hmappSystemConfig.LOGINURL),HMApp.constant("INDEXSTATE",hmappSystemConfig.INDEXSTATE)),HMApp.constant("COMMONSTATE",[{name:"403",url:"/403.html",templateUrl:"hm/views/403.html",data:{pageTitle:"403 - 禁止访问: 访问被拒绝。"},controller:"",ocLazyLoad:{name:"HMApp",files:[]}},{name:"404",url:"/404.html",templateUrl:"hm/views/404.html",data:{pageTitle:"404 - 找不到文件或目录。"},controller:"",ocLazyLoad:{name:"HMApp",files:[]}},{name:"500",url:"/500.html",templateUrl:"hm/views/500.html",data:{pageTitle:"500 - 内部服务器错误。"},controller:"",ocLazyLoad:{name:"HMApp",files:[]}}]),HMApp.factory("settings",["$rootScope",function(e){var a={layout:{pageSidebarClosed:!1,pageBodySolid:!0,pageAutoScrollOnLoad:1e3},layoutImgPath:"hm/img/",layoutCssPath:"hm/css/"};return e.settings=a,a}]),HMApp.controller("AppController",["$scope","$rootScope",function(e,a){e.$on("$viewContentLoaded",function(){})}]),HMApp.run(["$rootScope","settings","$state","$ocLazyLoad","$location","$localStorage","$sessionStorage","SYSNAME","LOGINURL","globalLazyLoad",function(e,a,t,n,o,r,i,c,l,p){r.authenticationToken||i.authenticationToken||(window.location=o.protocol()+"://"+o.host()+":"+o.port()+"/"+c+"/"+l),n.load("HMApp"),e.$state=t}]),function(){"use strict";HMApp.config(["$ocLazyLoadProvider","globalLazyLoad",function(e,a){e.config({debug:!0,events:!0,modules:[{name:"HMApp",insertBefore:"#ng_load_plugins_before",files:a.concat([])}]})}]),HMApp.config(["$controllerProvider",function(e){e.allowGlobals()}]),HMApp.config(["$stateProvider","$urlRouterProvider","INDEXSTATE","STATECONFIG","COMMONSTATE",function(e,a,t,n,o){null!=n&&n.length>0&&(""!=t&&a.otherwise(t),angular.forEach(n,function(a){e.state(a.name,{url:a.url,params:a.params,templateUrl:a.templateUrl,data:a.data,controller:a.controller,resolve:{deps:["$ocLazyLoad",function(e){return e.load($.extend({serie:!0},a.ocLazyLoad))}]}})}),angular.forEach(o,function(a){e.state(a.name,{url:a.url,params:a.params,templateUrl:a.templateUrl,data:a.data,controller:a.controller,resolve:{deps:["$ocLazyLoad",function(e){return e.load($.extend({serie:!0},a.ocLazyLoad))}]}})}))}])}(),HMApp.directive("ngDoLogout",["$location","$localStorage","$sessionStorage",function(e,a,t){function n(){delete a.authenticationToken,delete t.authenticationToken,delete t.userInfo,window.location.reload()}return{link:function(e,a,t){a.bind("click",function(){n()})}}}]),HMApp.directive("ngSpinnerBar",["$rootScope","$location","$localStorage","$sessionStorage","$state","SYSNAME","LOGINURL",function(e,a,t,n,o,r,i){return{link:function(o,c,l){c.addClass("hide"),e.$on("$stateChangeStart",function(){a.absUrl()!=i&&(t.authenticationToken||n.authenticationToken||(window.location=a.protocol()+"://"+a.host()+":"+a.port()+"/"+r+"/"+i)),c.removeClass("hide")}),e.$on("$stateChangeSuccess",function(){setTimeout(function(){matchMenu(function(){c.addClass("hide"),$("body").removeClass("page-on-load")})},1e3)}),e.$on("$stateNotFound",function(){c.addClass("hide")}),e.$on("$stateChangeError",function(){c.addClass("hide")})}}}]),HMApp.directive("a",function(){return{restrict:"E",link:function(e,a,t){(t.ngClick||""===t.href||"#"===t.href)&&a.on("click",function(e){e.preventDefault()})}}}),HMApp.directive("dropdownMenuHover",function(){return{link:function(e,a){a.dropdownHover()}}}),HMApp.directive("ngPageUtil",["$compile",function(e){function a(t,n){n.empty();var o=t.page,r=t.total;if(null!=r){var i=t.size,c=Math.ceil(r/i),l="<p>显示 <span>"+((o-1)*i+1)+" 到 "+(o*i>r?r:o*i)+"</span>条，共 <span>"+r+"</span> 条记录</p>";$(n[0]).append(l);var p='<li ng-class="{\'active\':page=={pageNum}}"><a ng-click="loadPage({page})">{pageStr}</a></li>',s='<li class="disabled"><a>...</a></li>',u='<li class="{disabled}"><a ng-click="loadPage({page})" aria-label="Previous"><span class="glyphicon glyphicon-triangle-left" aria-hidden="true"></span></a></li>',d='<li class="{disabled}"><a ng-click="loadPage({page})" aria-label="Next"><span class="glyphicon glyphicon-triangle-right" aria-hidden="true"></span></a></li>',g="";if(g+=1==o?u.replace("{disabled}","disabled").replace("{page}",1):u.replace("{disabled}","").replace("{page}",o-1),c<=7)for(var f=0;f<c;f++)g+=p.replace("{pageNum}",f+1).replace("{page}",f+1).replace("{pageStr}",f+1);else g+=p.replace("{pageNum}",1).replace("{page}",1).replace("{pageStr}",1),o<=4?(g+=p.replace("{pageNum}",2).replace("{page}",2).replace("{pageStr}",2),g+=p.replace("{pageNum}",3).replace("{page}",3).replace("{pageStr}",3),g+=p.replace("{pageNum}",4).replace("{page}",4).replace("{pageStr}",4),g+=p.replace("{pageNum}",5).replace("{page}",5).replace("{pageStr}",5),g+=s):o>=c-3?(g+=s,g+=p.replace("{pageNum}",c-4).replace("{page}",c-4).replace("{pageStr}",c-4),g+=p.replace("{pageNum}",c-3).replace("{page}",c-3).replace("{pageStr}",c-3),g+=p.replace("{pageNum}",c-2).replace("{page}",c-2).replace("{pageStr}",c-2),g+=p.replace("{pageNum}",c-1).replace("{page}",c-1).replace("{pageStr}",c-1)):(g+=s,g+=p.replace("{pageNum}",o-1).replace("{page}",o-1).replace("{pageStr}",o-1),g+=p.replace("{pageNum}",o).replace("{page}",o).replace("{pageStr}",o),g+=p.replace("{pageNum}",o+1).replace("{page}",o+1).replace("{pageStr}",o+1),g+=s),g+=p.replace("{pageNum}",c).replace("{page}",c).replace("{pageStr}",c);g+=o==c?d.replace("{disabled}","disabled").replace("{page}",c):d.replace("{disabled}","").replace("{page}",o+1),$(n[0]).append(e('<ul  class="pagination">'+g+"</ul>")(t)),n.find("li").on("click",function(){$(this).hasClass("disabled")||a(t,n)})}else setTimeout(function(){a(t,n)},100)}var t=[];return{link:function(e,n,o){a(e,n),t.push(e.$watch("total",function(e,t,o){a(o,n)})),e.$on("$destroy",function(){for(;t.length;)t.shift()()})}}}]),HMApp.directive("ngGoBack",["$window",function(e){return{link:function(a,t,n){t.on("click",function(a){e.history.back(),a.stopPropagation()})}}}]),function(){"use strict";function e(e,a,t,n,o,r){function i(a){e({method:"GET",url:r+"hmmsuser/api/tb_users/queryMenu",params:{loginId:t.userInfo.loginId,sysKey:o},data:{}}).success(function(e,o,r,i){0==e.list.length&&($(".page-spinner-bar").removeClass("hide"),$("body").addClass("page-on-load"),toastr.error("您没有权限进入该系统!","登陆失败"),delete n.authenticationToken,delete t.authenticationToken,delete t.userInfo,setTimeout(function(){window.location.reload()},2e3)),a(e.list,o,r,i)}).error(function(e,t,n,o){a(e,t,n,o)})}function c(){var t=a.defer();return e({method:"GET",url:r+"hmmsuser/api/tb_user",params:{},data:{}}).success(function(e,a,n,o){t.resolve(e)}).error(function(e,a,n,o){t.reject(e)}),t.promise}return{getSidebarInfo:function(e){null==t.userInfo?c().then(function(a){t.userInfo=a,i(e)}):i(e)},getUserInfo:c,changeMyPassword:function(t){var n=a.defer();return e({method:"GET",url:r+"api/account/change_password",params:{},data:t}).success(function(e,a,t,o){n.resolve(e)}).error(function(e,a,t,o){n.reject(e)}),n.promise}}}HMApp.service("hmappService",e),e.$inject=["$http","$q","$sessionStorage","$localStorage","SYSCODE","GATEWAYURL"]}();var Layout=function(){var e=function(e,a){var t=location.hash.toLowerCase(),n=$("#jquery-accordion-menu");if("click"===e||"set"===e)a=$(a);else if("match"===e){n.find("li > a");n.find("li > a").each(function(){var e=$(this).attr("href").toLowerCase();e.length>1&&t.substr(1,e.length-1)==e.substr(1)&&(a=$(this))})}a&&0!=a.size()&&"javascript:;"!==a.attr("href").toLowerCase()&&"#"!==a.attr("href").toLowerCase()&&(n.find("li.active").removeClass("active"),a.parents("li").each(function(){$(this).addClass("active"),$(this).find("> a").addClass("submenu-indicator-minus"),$(this).find("ul.submenu").size()>0&&$(this).find("ul.submenu").css("display","block")}))};return{setSidebarMenuActiveLink:function(a,t){e(a,t)}}}();!function(){"use strict";HMApp.config(["$httpProvider",function(e){e.interceptors.push("authInterceptor"),e.interceptors.push("authExpiredInterceptor")}])}(),function(){"use strict";function e(e,a,t,n,o,r,i){return{request:function(e){e.headers=e.headers||{};var a=n.authenticationToken||o.authenticationToken;return a?e.headers.Authorization="Bearer "+a:window.location=t.protocol()+"://"+t.host()+":"+t.port()+"/"+r+"/"+i,e}}}HMApp.factory("authInterceptor",e),e.$inject=["$rootScope","$q","$location","$localStorage","$sessionStorage","SYSNAME","LOGINURL"]}(),function(){"use strict";function e(e,a,t,n,o){return{responseError:function(e){return 401===e.status&&(delete n.authenticationToken,delete o.authenticationToken,delete o.userInfo,window.location.reload()),a.reject(e)}}}HMApp.factory("authExpiredInterceptor",e),e.$inject=["$rootScope","$q","$injector","$localStorage","$sessionStorage"]}();