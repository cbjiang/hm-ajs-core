function matchMenu(e){$("#jquery-accordion-menu").find("li").length>0?(Layout.setSidebarMenuActiveLink("match"),e()):setTimeout(function(){matchMenu(e)},100)}angular.module("hm.appcore",["ui.router","ui.bootstrap","oc.lazyLoad","ngSanitize","ngStorage"]),null!=hmappSystemConfig&&(angular.module("hm.appcore").constant("SYSNAME",hmappSystemConfig.SYSNAME),angular.module("hm.appcore").constant("SYSCODE",hmappSystemConfig.SYSCODE),angular.module("hm.appcore").constant("VERSION",hmappSystemConfig.VERSION),angular.module("hm.appcore").constant("GATEWAYURL",hmappSystemConfig.GATEWAYURL),angular.module("hm.appcore").constant("LOGINURL",hmappSystemConfig.LOGINURL),angular.module("hm.appcore").constant("INDEXSTATE",hmappSystemConfig.INDEXSTATE)),angular.module("hm.appcore").constant("COMMONSTATE",[{name:"403",url:"/403.html",templateUrl:"hm/views/403.html",data:{pageTitle:"403 - 禁止访问: 访问被拒绝。"},controller:"",ocLazyLoad:{name:"hm.appcore",files:[]}},{name:"404",url:"/404.html",templateUrl:"hm/views/404.html",data:{pageTitle:"404 - 找不到文件或目录。"},controller:"",ocLazyLoad:{name:"hm.appcore",files:[]}},{name:"500",url:"/500.html",templateUrl:"hm/views/500.html",data:{pageTitle:"500 - 内部服务器错误。"},controller:"",ocLazyLoad:{name:"hm.appcore",files:[]}}]),angular.module("hm.appcore").factory("settings",["$rootScope",function(e){var a={layout:{pageSidebarClosed:!1,pageBodySolid:!0,pageAutoScrollOnLoad:1e3},layoutImgPath:"hm/img/",layoutCssPath:"hm/css/"};return e.settings=a,a}]),angular.module("hm.appcore").controller("AppController",["$scope","$rootScope",function(e,a){e.$on("$viewContentLoaded",function(){})}]),angular.module("hm.appcore").run(["$rootScope","settings","$state","$ocLazyLoad","$location","$localStorage","$sessionStorage","SYSNAME","LOGINURL",function(e,a,t,o,n,r,s,l,p){r.authenticationToken||s.authenticationToken||(window.location=n.protocol()+"://"+n.host()+":"+n.port()+"/"+l+"/"+p),o.load("hm.appcore"),e.$state=t}]),function(){"use strict";angular.module("hm.appcore").config(["$ocLazyLoadProvider","globalLazyLoad",function(e,a){e.config({debug:!0,events:!0,modules:[{name:"hm.appcore",insertBefore:"#ng_load_plugins_before",files:a.concat([])}]})}]),angular.module("hm.appcore").config(["$controllerProvider",function(e){e.allowGlobals()}]),angular.module("hm.appcore").config(["$stateProvider","$urlRouterProvider","INDEXSTATE","STATECONFIG","COMMONSTATE",function(e,a,t,o,n){null!=o&&o.length>0&&(""!=t&&a.otherwise(t),angular.forEach(o,function(a){e.state(a.name,{url:a.url,params:a.params,templateUrl:a.templateUrl,data:a.data,controller:a.controller,resolve:{deps:["$ocLazyLoad",function(e){return e.load($.extend({serie:!0},a.ocLazyLoad))}]}})}),angular.forEach(n,function(a){e.state(a.name,{url:a.url,params:a.params,templateUrl:a.templateUrl,data:a.data,controller:a.controller,resolve:{deps:["$ocLazyLoad",function(e){return e.load($.extend({serie:!0},a.ocLazyLoad))}]}})}))}]),angular.module("hm.appcore").provider("test",function(){console.log("instance test");var e=function(e){alert("Hello, "+e)};this.$get=function(){return e}})}(),angular.module("hm.appcore").directive("ngDoLogout",["$location","$localStorage","$sessionStorage",function(e,a,t){function o(){delete a.authenticationToken,delete t.authenticationToken,delete t.userInfo,window.location.reload()}return{link:function(e,a,t){a.bind("click",function(){o()})}}}]),angular.module("hm.appcore").directive("ngSpinnerBar",["$rootScope","$location","$localStorage","$sessionStorage","$state","SYSNAME","LOGINURL",function(e,a,t,o,n,r,s){return{link:function(n,l,p){l.addClass("hide"),e.$on("$stateChangeStart",function(){a.absUrl()!=s&&(t.authenticationToken||o.authenticationToken||(window.location=a.protocol()+"://"+a.host()+":"+a.port()+"/"+r+"/"+s)),l.removeClass("hide")}),e.$on("$stateChangeSuccess",function(){setTimeout(function(){matchMenu(function(){l.addClass("hide"),$("body").removeClass("page-on-load")})},1e3)}),e.$on("$stateNotFound",function(){l.addClass("hide")}),e.$on("$stateChangeError",function(){l.addClass("hide")})}}}]),angular.module("hm.appcore").directive("a",function(){return{restrict:"E",link:function(e,a,t){(t.ngClick||""===t.href||"#"===t.href)&&a.on("click",function(e){e.preventDefault()})}}}),angular.module("hm.appcore").directive("dropdownMenuHover",function(){return{link:function(e,a){a.dropdownHover()}}}),angular.module("hm.appcore").directive("ngPageUtil",["$compile",function(e){function a(t,o){o.empty();var n=t.page,r=t.total;if(null!=r){var s=t.size,l=Math.ceil(r/s),p="<p>当前显示<span>"+((n-1)*s+1)+"到"+(n*s>r?r:n*s)+"</span>条，共<span>"+r+"</span>条记录</p>";$(o[0]).append(p);var i='<li ng-class="{\'active\':page=={pageNum}}"><a ng-click="loadPage({page})">{pageStr}</a></li>',c='<li class="disabled"><a>...</a></li>',u='<li class="{disabled}"><a ng-click="loadPage({page})" aria-label="Previous"><span class="glyphicon glyphicon-triangle-left" aria-hidden="true"></span></a></li>',m='<li class="{disabled}"><a ng-click="loadPage({page})" aria-label="Next"><span class="glyphicon glyphicon-triangle-right" aria-hidden="true"></span></a></li>',g="";if(g+=1==n?u.replace("{disabled}","disabled").replace("{page}",1):u.replace("{disabled}","").replace("{page}",n-1),l<=7)for(var h=0;h<l;h++)g+=i.replace("{pageNum}",h+1).replace("{page}",h+1).replace("{pageStr}",h+1);else g+=i.replace("{pageNum}",1).replace("{page}",1).replace("{pageStr}",1),n<=4?(g+=i.replace("{pageNum}",2).replace("{page}",2).replace("{pageStr}",2),g+=i.replace("{pageNum}",3).replace("{page}",3).replace("{pageStr}",3),g+=i.replace("{pageNum}",4).replace("{page}",4).replace("{pageStr}",4),g+=i.replace("{pageNum}",5).replace("{page}",5).replace("{pageStr}",5),g+=c):n>=l-3?(g+=c,g+=i.replace("{pageNum}",l-4).replace("{page}",l-4).replace("{pageStr}",l-4),g+=i.replace("{pageNum}",l-3).replace("{page}",l-3).replace("{pageStr}",l-3),g+=i.replace("{pageNum}",l-2).replace("{page}",l-2).replace("{pageStr}",l-2),g+=i.replace("{pageNum}",l-1).replace("{page}",l-1).replace("{pageStr}",l-1)):(g+=c,g+=i.replace("{pageNum}",n-1).replace("{page}",n-1).replace("{pageStr}",n-1),g+=i.replace("{pageNum}",n).replace("{page}",n).replace("{pageStr}",n),g+=i.replace("{pageNum}",n+1).replace("{page}",n+1).replace("{pageStr}",n+1),g+=c),g+=i.replace("{pageNum}",l).replace("{page}",l).replace("{pageStr}",l);g+=n==l?m.replace("{disabled}","disabled").replace("{page}",l):m.replace("{disabled}","").replace("{page}",n+1),$(o[0]).append(e('<ul  class="pagination">'+g+"</ul>")(t)),o.find("li").on("click",function(){$(this).hasClass("disabled")||a(t,o)})}else setTimeout(function(){a(t,o)},100)}var t=[];return{link:function(e,o,n){a(e,o),t.push(e.$watch("total",function(e,t,n){a(n,o)})),e.$on("$destroy",function(){for(;t.length;)t.shift()()})}}}]),angular.module("hm.appcore").directive("ngGoBack",["$window",function(e){return{link:function(a,t,o){t.on("click",function(a){e.history.back(),a.stopPropagation()})}}}]);var outClass,inClass;angular.module("hm.appcore").factory("hmState",["$state",function(e){function a(e){switch(e){case 1:outClass="hm-page-moveToLeftFade",inClass="hm-page-moveFromRightFade";break;case 2:outClass="hm-page-moveToTopFade",inClass="hm-page-moveFromBottomFade";break;case 3:outClass="hm-page-moveToBottomFade",inClass="hm-page-moveFromTopFade";break;case 4:outClass="hm-page-scaleDown",inClass="hm-page-scaleUpDown hm-page-delay300";break;case 5:outClass="hm-page-scaleDownUp",inClass="hm-page-scaleUp hm-page-delay300";break;case 6:outClass="hm-page-moveToLeft hm-page-ontop",inClass="hm-page-scaleUp";break;case 7:outClass="hm-page-scaleDownCenter",inClass="hm-page-scaleUpCenter hm-page-delay400";break;case 8:outClass="hm-page-rotateBottomSideFirst",inClass="hm-page-moveFromBottom hm-page-delay200 hm-page-ontop";break;case 9:outClass="hm-page-flipOutRight",inClass="hm-page-flipInLeft hm-page-delay500";break;case 10:outClass="hm-page-flipOutLeft",inClass="hm-page-flipInRight hm-page-delay500";break;case 11:outClass="hm-page-flipOutTop",inClass="hm-page-flipInBottom hm-page-delay500";break;case 12:outClass="hm-page-flipOutBottom",inClass="hm-page-flipInTop hm-page-delay500";break;case 13:outClass="hm-page-rotateFall hm-page-ontop",inClass="hm-page-scaleUp";break;case 14:outClass="hm-page-rotateOutNewspaper",inClass="hm-page-rotateInNewspaper hm-page-delay500";break;case 15:outClass="hm-page-rotatePushLeft",inClass="hm-page-rotatePullRight hm-page-delay180";break;case 16:outClass="hm-page-rotatePushRight",inClass="hm-page-rotatePullLeft hm-page-delay180";break;case 17:outClass="hm-page-rotatePushTop",inClass="hm-page-rotatePullBottom hm-page-delay180";break;case 18:outClass="hm-page-rotatePushBottom",inClass="hm-page-rotatePullTop hm-page-delay180";break;case 19:outClass="hm-page-moveToRightFade",inClass="hm-page-rotateUnfoldLeft";break;case 20:outClass="hm-page-moveToLeftFade",inClass="hm-page-rotateUnfoldRight";break;case 21:outClass="hm-page-moveToBottomFade",inClass="hm-page-rotateUnfoldTop";break;case 22:outClass="hm-page-moveToTopFade",inClass="hm-page-rotateUnfoldBottom";break;case 23:outClass="hm-page-rotateRoomLeftOut hm-page-ontop",inClass="hm-page-rotateRoomLeftIn";break;case 24:outClass="hm-page-rotateRoomRightOut hm-page-ontop",inClass="hm-page-rotateRoomRightIn";break;case 25:outClass="hm-page-rotateRoomTopOut hm-page-ontop",inClass="hm-page-rotateRoomTopIn";break;case 26:outClass="hm-page-rotateRoomBottomOut hm-page-ontop",inClass="hm-page-rotateRoomBottomIn";break;case 27:outClass="hm-page-rotateCubeLeftOut hm-page-ontop",inClass="hm-page-rotateCubeLeftIn";break;case 28:outClass="hm-page-rotateCubeRightOut hm-page-ontop",inClass="hm-page-rotateCubeRightIn";break;case 29:outClass="hm-page-rotateCubeTopOut hm-page-ontop",inClass="hm-page-rotateCubeTopIn";break;case 30:outClass="hm-page-rotateCubeBottomOut hm-page-ontop",inClass="hm-page-rotateCubeBottomIn";break;case 31:outClass="hm-page-rotateCarouselLeftOut hm-page-ontop",inClass="hm-page-rotateCarouselLeftIn";break;case 32:outClass="hm-page-rotateCarouselRightOut hm-page-ontop",inClass="hm-page-rotateCarouselRightIn";break;case 33:outClass="hm-page-rotateCarouselTopOut hm-page-ontop",inClass="hm-page-rotateCarouselTopIn";break;case 34:outClass="hm-page-rotateCarouselBottomOut hm-page-ontop",inClass="hm-page-rotateCarouselBottomIn";break;case 35:outClass="hm-page-rotateSidesOut",inClass="hm-page-rotateSidesIn hm-page-delay200";break;case 36:outClass="hm-page-rotateSlideOut",inClass="hm-page-rotateSlideIn"}}var t=0;return{go:function(o,n,r){36==t&&(t=0),a(++t),$(".main-view").toggleClass().addClass("main-view hm-page").addClass(outClass),e.go(o,n),$(".child-view").toggleClass().addClass("child-view hm-page").addClass(inClass).addClass("hm-page-current"),console.log("go"),setTimeout(function(){$(".main-view").removeClass("hm-page-current"),"function"==typeof r&&r()},600)}}}]),angular.module("hm.appcore").directive("hmStateGoBack",["$window",function(e){return{link:function(a,t,o){t.on("click",function(a){$(".child-view").toggleClass().addClass("child-view hm-page").addClass(outClass),$(".main-view").toggleClass().addClass("main-view hm-page").addClass(inClass).addClass("hm-page-current"),setTimeout(function(){$(".child-view").removeClass("hm-page-current"),"function"==typeof callback&&callback()},600),e.history.back(),a.stopPropagation()})}}}]),function(){"use strict";function e(e,a,t,o,n,r){function s(a){e({method:"GET",url:r+"hmmsuser/api/tb_users/queryMenu",params:{loginId:t.userInfo.loginId,sysKey:n},data:{}}).success(function(e,n,r,s){0==e.list.length&&($(".page-spinner-bar").removeClass("hide"),$("body").addClass("page-on-load"),toastr.error("您没有权限进入该系统!","登陆失败"),delete o.authenticationToken,delete t.authenticationToken,delete t.userInfo,setTimeout(function(){window.location.reload()},2e3)),a(e.list,n,r,s)}).error(function(e,t,o,n){a(e,t,o,n)})}function l(){var t=a.defer();return e({method:"GET",url:r+"hmmsuser/api/tb_user",params:{},data:{}}).success(function(e,a,o,n){t.resolve(e)}).error(function(e,a,o,n){t.reject(e)}),t.promise}return{getSidebarInfo:function(e){null==t.userInfo?l().then(function(a){t.userInfo=a,s(e)}):s(e)},getUserInfo:l,changeMyPassword:function(t,o){var n=a.defer();return e({method:"POST",url:r+"api/account/change_my_password",params:{},data:{password:t,oldPassword:o}}).success(function(e,a,t,o){n.resolve(e)}).error(function(e,a,t,o){n.reject(e)}),n.promise}}}angular.module("hm.appcore").service("hmappService",e),e.$inject=["$http","$q","$sessionStorage","$localStorage","SYSCODE","GATEWAYURL"]}();var Layout=function(){var e=function(e,a){var t=location.hash.toLowerCase(),o=$("#jquery-accordion-menu");if("click"===e||"set"===e)a=$(a);else if("match"===e){o.find("li > a");o.find("li > a").each(function(){var e=null==$(this).attr("href")?"":$(this).attr("href").toLowerCase();e.length>1&&t.substr(1,e.length-1)==e.substr(1)&&(a=$(this))})}a&&0!=a.size()&&"javascript:;"!==a.attr("href").toLowerCase()&&"#"!==a.attr("href").toLowerCase()&&(o.find("li.active").removeClass("active"),a.parents("li").each(function(){$(this).addClass("active"),$(this).find("> a").addClass("submenu-indicator-minus"),$(this).find("ul.submenu").size()>0&&$(this).find("ul.submenu").css("display","block")}))};return{setSidebarMenuActiveLink:function(a,t){e(a,t)}}}();!function(){"use strict";angular.module("hm.appcore").config(["$httpProvider",function(e){e.interceptors.push("authInterceptor"),e.interceptors.push("authExpiredInterceptor")}])}(),function(){"use strict";function e(e,a,t,o,n,r,s){return{request:function(e){e.headers=e.headers||{};var a=o.authenticationToken||n.authenticationToken;return a?e.headers.Authorization="Bearer "+a:window.location=t.protocol()+"://"+t.host()+":"+t.port()+"/"+r+"/"+s,e}}}angular.module("hm.appcore").factory("authInterceptor",e),e.$inject=["$rootScope","$q","$location","$localStorage","$sessionStorage","SYSNAME","LOGINURL"]}(),function(){"use strict";function e(e,a,t,o,n){return{responseError:function(e){return 401===e.status&&(delete o.authenticationToken,delete n.authenticationToken,delete n.userInfo,window.location.reload()),a.reject(e)}}}angular.module("hm.appcore").factory("authExpiredInterceptor",e),e.$inject=["$rootScope","$q","$injector","$localStorage","$sessionStorage"]}();